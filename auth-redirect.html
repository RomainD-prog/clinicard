<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Retour à l’app…</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <style>
      body { font-family: -apple-system, system-ui; padding: 24px; }
      .muted { color: #666; }
      code { background: #f3f3f3; padding: 2px 6px; border-radius: 6px; }
    </style>
  </head>
  <body>
    <h2>Retour à l’app…</h2>
    <p class="muted">Si rien ne se passe, tu peux appuyer sur le bouton ci-dessous.</p>
    <p><a id="open" href="#">Ouvrir l’app</a></p>

    <script>
      // On récupère query + hash (Supabase met parfois les infos dans #)
      const q = window.location.search || "";
      const h = window.location.hash || "";

      // IMPORTANT:
      // - En prod/dev-build: medflash://auth/reset
      // - En Expo Go: il faudrait exp://... (mais ça change selon le LAN)
      // Donc on privilégie medflash:// (pour build), et on garde compat sur Expo Go via tes Redirect URLs exp://*
      const deepLink = "medflash://auth/reset" + q + h;

      const a = document.getElementById("open");
      a.href = deepLink;

      // Auto open
      window.location.replace(deepLink);

      // Fallback : si iOS bloque, on affiche juste le lien cliquable
    </script>
  </body>
</html>
